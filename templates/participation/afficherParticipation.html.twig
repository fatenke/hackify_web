{% extends 'base.html.twig' %}

{% block title %}Participants - {{ hackathon.nom_hackathon }}{% endblock %}

{% block body %}
<div class="container mt-5">
  <h2>Participants au hackathon : {{ hackathon.nom_hackathon }}</h2>

  {% if participations is empty %}
    <p>Aucun participant pour le moment.</p>
  {% else %}
    <ul class="nav nav-tabs d-flex justify-content-center" data-aos="fade-up" data-aos-delay="100">
      <li class="nav-item">
        <a class="nav-link active show" data-bs-toggle="tab" data-bs-target="#en-attente">
          <h4>En attente</h4>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-bs-toggle="tab" data-bs-target="#validé">
          <h4>Validé</h4>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-bs-toggle="tab" data-bs-target="#refusé">
          <h4>Refusé</h4>
        </a>
      </li>
    </ul>

    {% set statuts = ['En attente', 'validé', 'refusé'] %}
<div class="tab-content mt-4">
  {% for statut in statuts %}
    {% set statut_id = statut|lower|replace({' ': '-'}) %}
    <div class="tab-pane fade {% if loop.first %}show active{% endif %}" id="{{ statut_id }}">
      <h3 class="text-center mb-3">Participations : {{ statut }}</h3>

      {% set participations_filtrees = participations|filter(p => p.statut == statut) %}

      {% if participations_filtrees is not empty %}
        <div class="table-responsive">
          <table class="table table-hover align-middle text-center">
            <thead class="table-dark">
              <tr>
                <th>Image</th>
                <th>Nom</th>
                <th>Prénom</th>
                <th>Email</th>
                <th>Date d'inscription</th>
                <th>Statut</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for participation in participations_filtrees %}
                <tr>
                  <td>
                    <img src="{{ asset('FrontOffice/assets/img/default-use.png') }}"
                         alt="Image profil"
                         width="60"
                         height="60"
                         class="rounded-circle border">
                  </td>
                  <td>nom</td>
                  <td>prenom</td>
                  <td>email</td>
                  <td>{{ participation.date_inscription|date('d/m/Y H:i') }}</td>
                  <td>{{ participation.statut }}</td>
                  <td>
                    {% if participation.statut == 'En attente' %}
                      <a href="{{ path('valider_participation', { id: participation.id_participation }) }}" class="btn btn-outline-success btn-sm">Valider</a>
                      <a href="{{ path('refuser_participation', { id: participation.id_participation }) }}" class="btn btn-outline-danger btn-sm">Refuser</a>
                    {% else %}
                      <span class="text-muted fst-italic">Aucune action</span>
                    {% endif %}
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p class="text-center text-muted">Aucune participation {{ statut|lower }} pour le moment.</p>
      {% endif %}
    </div>
  {% endfor %}
</div>
  {% endif %}
</div>
{% endblock %}


