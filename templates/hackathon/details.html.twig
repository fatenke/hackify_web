{% extends 'base.html.twig' %}

{% block title %}Détails du Hackathon{% endblock %}

{% block body %}
<section class="section">
  <div class="container">
    <h1 class="mb-4">{{ hackathon.nom_hackathon }}</h1>
    <p><span class="icon">📍</span><strong>Lieu :</strong> {{ hackathon.lieu }}</p>
    <p><span class="icon">🗓️</span><strong>Date de début :</strong> {{ hackathon.date_debut ? hackathon.date_debut|date('d/m/Y') : 'N/A' }}</p>
    <p><span class="icon">🗓️</span><strong>Date de fin :</strong> {{ hackathon.date_fin ? hackathon.date_fin|date('d/m/Y') : 'N/A' }}</p>
    <p><span class="icon">📝</span><strong>Description :</strong> {{ hackathon.description }}</p>
    <div>
    <br>
    {% if hackathon.participations|length < hackathon.max_participants %}
    {% if app.user and 'ROLE_PARTICIPANT' in app.user.roles %}
    {% set isAlreadyParticipant = false %}
                      {% for participation in participations %}
                        {% if participation.hackathon.id_hackathon == hackathon.id_hackathon %}
                          {% set isAlreadyParticipant = true %}
                        {% endif %}
                      {% endfor %}
                      {% if not isAlreadyParticipant %}
    <a href="{{ path('hackathon_participer', { id: hackathon.id_hackathon }) }}" class="btn btn-primary">Participer</a>
    {% else %}
    <a href="{{ path('app_projets', { id: hackathon.id_hackathon }) }}" class="btn btn-primary">Soummettre le projet</a>
    {% endif %}
    {% endif %}
    {% else %}
    <span class="badge bg-danger">Complet</span>
    {% endif %}

    </div>
    <br>
    <div>
    {% if app.user and 'ROLE_ORGANISATEUR' in app.user.roles %}
    {% if hackathon.id_organisateur.id == app.user.id %}
    <a href="{{ path('modifier_hackathon', { id: hackathon.id_hackathon }) }}" class="btn btn-primary">Modifier</a>
    <form method="post" action="{{ path('supprimer_hackathon', {id: hackathon.id_hackathon}) }}" style="display:inline;" onsubmit="return confirm('Es-tu sûr(e) ?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('supprimer' ~ hackathon.id_hackathon) }}">
                     <button class="btn btn-primary">Supprimer</button>
                    </form>
                    <a href="{{ path('voir_participants', { id: hackathon.id_hackathon}) }}" class="btn btn-secondary" >Voir les participants</a>
                    <a href="{{ path('voir_projets', { id: hackathon.id_hackathon}) }}" class="btn btn-secondary">Voir les projets</a>
{% endif %}
{% endif %}
                    </div>
      
  </div>
</section>
{% endblock %}
